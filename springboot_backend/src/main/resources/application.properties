# ============================================
# Spring Boot Application Configuration
# ============================================
# 使用环境变量进行配置，参考 template.env 文件

# 应用名称
spring.application.name=${SPRING_APPLICATION_NAME:springboot_backend}

# 服务器配置
server.port=${SERVER_PORT:8080}
# 服务前置URL（应用上下文路径），所有接口都会加上此前缀
# 例如：设置为 /api 后，访问路径变为 http://localhost:8080/api/api/v1/login
server.servlet.context-path=${SERVER_CONTEXT_PATH:}

# API基础路径配置（用于Controller中的@RequestMapping）
# 注意：此配置需要配合代码使用，当前Controller中硬编码了 /api/v1
# 如需动态配置，需要修改Controller使用此配置值
API_BASE_PATH=${API_BASE_PATH:/api/v1}

# ============================================
# 数据库配置
# ============================================
# 数据源配置
spring.datasource.url=${SPRING_DATASOURCE_URL:jdbc:h2:mem:talk2me}
spring.datasource.username=${SPRING_DATASOURCE_USERNAME:sa}
spring.datasource.password=${SPRING_DATASOURCE_PASSWORD:}
spring.datasource.driver-class-name=${SPRING_DATASOURCE_DRIVER_CLASS_NAME:org.h2.Driver}

# JPA/Hibernate配置
spring.jpa.hibernate.ddl-auto=${SPRING_JPA_HIBERNATE_DDL_AUTO:update}
spring.jpa.show-sql=${SPRING_JPA_SHOW_SQL:false}
spring.jpa.properties.hibernate.format_sql=${SPRING_JPA_PROPERTIES_HIBERNATE_FORMAT_SQL:true}
# 禁用Open Session In View（RESTful API不需要在视图渲染期间保持数据库连接）
spring.jpa.open-in-view=false

# ============================================
# Redis配置（Session存储）
# ============================================
spring.data.redis.host=${SPRING_DATA_REDIS_HOST:localhost}
spring.data.redis.port=${SPRING_DATA_REDIS_PORT:6379}
spring.data.redis.password=${SPRING_DATA_REDIS_PASSWORD:}
spring.data.redis.database=${SPRING_DATA_REDIS_DATABASE:0}
spring.data.redis.timeout=${SPRING_DATA_REDIS_TIMEOUT:2000ms}
spring.data.redis.lettuce.pool.max-active=${SPRING_DATA_REDIS_LETTUCE_POOL_MAX_ACTIVE:8}
spring.data.redis.lettuce.pool.max-wait=${SPRING_DATA_REDIS_LETTUCE_POOL_MAX_WAIT:-1ms}
spring.data.redis.lettuce.pool.max-idle=${SPRING_DATA_REDIS_LETTUCE_POOL_MAX_IDLE:8}
spring.data.redis.lettuce.pool.min-idle=${SPRING_DATA_REDIS_LETTUCE_POOL_MIN_IDLE:0}

# Session配置
spring.session.store-type=${SPRING_SESSION_STORE_TYPE:redis}
server.servlet.session.timeout=${SPRING_SESSION_TIMEOUT:1800}

# ============================================
# Kafka配置
# ============================================
spring.kafka.bootstrap-servers=${SPRING_KAFKA_BOOTSTRAP_SERVERS:localhost:9092}
spring.kafka.consumer.group-id=${SPRING_KAFKA_CONSUMER_GROUP_ID:talk2me-group}
spring.kafka.consumer.enable-auto-commit=${SPRING_KAFKA_CONSUMER_ENABLE_AUTO_COMMIT:true}
spring.kafka.consumer.auto-commit-interval=${SPRING_KAFKA_CONSUMER_AUTO_COMMIT_INTERVAL:1000}
spring.kafka.consumer.key-deserializer=${SPRING_KAFKA_CONSUMER_KEY_DESERIALIZER:org.apache.kafka.common.serialization.StringDeserializer}
spring.kafka.consumer.value-deserializer=${SPRING_KAFKA_CONSUMER_VALUE_DESERIALIZER:org.apache.kafka.common.serialization.StringDeserializer}
spring.kafka.producer.key-serializer=${SPRING_KAFKA_PRODUCER_KEY_SERIALIZER:org.apache.kafka.common.serialization.StringSerializer}
spring.kafka.producer.value-serializer=${SPRING_KAFKA_PRODUCER_VALUE_SERIALIZER:org.apache.kafka.common.serialization.StringSerializer}
spring.kafka.producer.acks=${SPRING_KAFKA_PRODUCER_ACKS:1}
spring.kafka.producer.retries=${SPRING_KAFKA_PRODUCER_RETRIES:3}

# ============================================
# 文件上传配置
# ============================================
spring.servlet.multipart.max-file-size=${SPRING_SERVLET_MULTIPART_MAX_FILE_SIZE:10MB}
spring.servlet.multipart.max-request-size=${SPRING_SERVLET_MULTIPART_MAX_REQUEST_SIZE:50MB}

# ============================================
# 日志配置
# ============================================
logging.level.root=${LOGGING_LEVEL_ROOT:INFO}
logging.level.com.example.springboot_backend=${LOGGING_LEVEL_COM_EXAMPLE_SPRINGBOOT_BACKEND:DEBUG}
logging.file.path=${LOGGING_FILE_PATH:logs}
logging.file.name=${LOGGING_FILE_NAME:logs/springboot_backend.log}
logging.logback.rollingpolicy.max-file-size=${LOGGING_FILE_MAX_SIZE:10MB}
logging.logback.rollingpolicy.max-history=${LOGGING_FILE_MAX_HISTORY:30}

# ============================================
# 应用环境配置
# ============================================
spring.profiles.active=${SPRING_PROFILES_ACTIVE:dev}
